(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{162:function(e,t){},164:function(e,t){},172:function(e,t,n){},183:function(e,t,n){},184:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(10),r=n.n(c),i=(n(131),n(17)),s=n(219),o=n(220),l=n(218),d=n(221),u=n(222),j=n(223),b=n(224),m=n(225),O=n(226),p=n(227),x=n(14),f=n(46),h=n.n(f),g=n(49),v=n.n(g),y=n(2),w=Object(a.createContext)(),k=Object(f.io)("https://microsoft-engage-teams.herokuapp.com/"),C=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(x.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)(!1),o=Object(x.a)(s,2),l=o[0],d=o[1],u=Object(a.useState)(),j=Object(x.a)(u,2),b=j[0],m=j[1],O=Object(a.useState)(""),p=Object(x.a)(O,2),f=p[0],h=p[1],g=Object(a.useState)({}),C=Object(x.a)(g,2),S=C[0],N=C[1],I=Object(a.useState)(""),M=Object(x.a)(I,2),D=M[0],V=M[1],T=Object(a.useState)(!0),R=Object(x.a)(T,2),U=R[0],A=R[1],E=Object(a.useState)(),B=Object(x.a)(E,2),P=B[0],z=B[1],W=Object(a.useState)(!0),H=Object(x.a)(W,2),L=H[0],F=H[1],J=Object(a.useState)(),Y=Object(x.a)(J,2),q=Y[0],G=Y[1],K=Object(a.useState)(!1),Q=Object(x.a)(K,2),X=Q[0],Z=Q[1],$=Object(a.useState)(""),_=Object(x.a)($,2),ee=(_[0],_[1]),te=Object(a.useRef)(),ne=Object(a.useRef)(),ae=Object(a.useRef)();Object(a.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){m(e),te.current.srcObject=e})),k.on("me",(function(e){return V(e)})),k.on("callUser",(function(e){var t=e.from,n=e.name,a=e.signal;N({isReceivingCall:!0,from:t,name:n,signal:a})})),k.on("updateUserMedia",(function(e){var t=e.type,n=e.currentMediaStatus;if(null!==n||n!==[])switch(t){case"video":z(n);break;case"mic":G(n);break;default:G(n[0]),z(n[1])}})),k.on("endCall",(function(){window.location.reload()})),k.on("msgRcv",(function(e){e.name;var t=e.msg,n=e.sender;ee({value:t,sender:n}),setTimeout((function(){ee({})}),2e3)}))}),[]);return Object(y.jsx)(w.Provider,{value:{call:S,callAccepted:r,myVideo:te,userVideo:ne,stream:b,name:f,setName:h,callEnded:l,me:D,callUser:function(e){var t=new v.a({initiator:!0,trickle:!1,stream:b});t.on("signal",(function(t){k.emit("callUser",{userToCall:e,signalData:t,from:D,name:f})})),t.on("stream",(function(e){ne.current.srcObject=e})),k.on("callAccepted",(function(e){i(!0),t.signal(e),k.emit("updateMyMedia",{type:"both",currentMediaStatus:[L,U]})})),ae.current=t},leaveCall:function(){d(!0),ae.current.destroy(),window.location.reload()},shareScreen:function(){navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){Z(!0),m(b),te.current.srcObject=e;var t=e.getVideoTracks()[0],n=ae.current;n&&n.replaceTrack(n.streams[0].getVideoTracks()[0],t,n.streams[0]),t.onended=function(){n.replaceTrack(n.streams[0].getVideoTracks()[0],b.getVideoTracks()[0],n.streams[0]),te.current.srcObject=b}}))},answerCall:function(){i(!0);var e=new v.a({initiator:!1,trickle:!1,stream:b});e.on("signal",(function(e){k.emit("answerCall",{signal:e,to:S.from,type:"both",myMediaStatus:[L,U]})})),e.on("stream",(function(e){ne.current.srcObject=e})),e.signal(S.signal),ae.current=e},stopScreenShare:function(){Z(!1);var e=ae.current;e.replaceTrack(e.streams[0].getVideoTracks()[0],b.getVideoTracks()[0],e.streams[0]),te.current.srcObject=b},setMyVdoStatus:A,screenShare:X,userVdoStatus:P,setUserVdoStatus:z,updateVideo:function(){A((function(e){return k.emit("updateMyMedia",{type:"video",currentMediaStatus:!e}),b.getVideoTracks()[0].enabled=!e,!e}))},myMicStatus:L,userMicStatus:q,updateMic:function(){F((function(e){return k.emit("updateMyMedia",{type:"mic",currentMediaStatus:!e}),b.getAudioTracks()[0].enabled=!e,!e}))}},children:t})},S=n(234),N=n(76),I=n(68),M=n(231);n(172);var D,V,T=function(){var e=Object(a.useState)({message:"",name:""}),t=Object(x.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)([]),s=Object(x.a)(r,2),o=s[0],l=s[1],d=Object(a.useRef)();Object(a.useEffect)((function(){return d.current=h.a.connect("https://microsoft-engage-teams.herokuapp.com/"),d.current.on("message",(function(e){var t=e.name,n=e.message;l([].concat(Object(I.a)(o),[{name:t,message:n}]))})),function(){return d.current.disconnect()}}),[o]);var u=function(e){c(Object(N.a)(Object(N.a)({},n),{},Object(i.a)({},e.target.name,e.target.value)))};return Object(y.jsxs)("div",{className:"card ",children:[Object(y.jsxs)("form",{onSubmit:function(e){var t=n.name,a=n.message;d.current.emit("message",{name:t,message:a}),e.preventDefault(),c({message:"",name:t})},children:[Object(y.jsx)("h1",{children:"Messenger"}),Object(y.jsx)("div",{className:"name-field",children:Object(y.jsx)(M.a,{name:"name",onChange:function(e){return u(e)},value:n.name,label:"UserName"})}),Object(y.jsx)("div",{children:Object(y.jsx)(M.a,{name:"message",onChange:function(e){return u(e)},value:n.message,id:"outlined-multiline-static",variant:"outlined",label:"Message"})}),Object(y.jsx)("button",{children:"Send Message"})]}),Object(y.jsxs)("div",{className:"render-chat",children:[Object(y.jsx)("h1",{children:"Chat Log"}),o.map((function(e,t){var n=e.name,a=e.message;return Object(y.jsx)("div",{children:Object(y.jsxs)("h5",{children:[n,": ",Object(y.jsx)("span",{children:a})]})},t)}))]})]})},R=Object(s.a)((function(e){return{uservideo:Object(i.a)({width:"650px"},e.breakpoints.down("xs"),{width:"400px"}),myvideo:Object(i.a)({width:"650px"},e.breakpoints.down("xs"),{width:"400px"}),gridContainer:Object(i.a)({justifyContent:"center"},e.breakpoints.down("xs"),{flexDirection:"column"}),paper:{padding:"10px",border:"2px solid black",margin:"10px"}}})),U=function(){var e=Object(a.useContext)(w),t=e.name,n=e.callAccepted,c=e.myVideo,r=e.updateVideo,i=e.myMicStatus,s=e.updateMic,x=e.userVideo,f=e.callEnded,h=e.shareScreen,g=e.screenShare,v=e.stopScreenShare,k=e.stream,C=e.call,N=R();return Object(y.jsxs)(o.a,{container:!0,className:N.gridContainer,children:[k&&Object(y.jsxs)(l.a,{className:N.paper,children:[Object(y.jsxs)(o.a,{item:!0,xs:6,sm:3,children:[Object(y.jsx)(d.a,{variant:"h5",gutterBottom:!0,children:t||"Name"}),Object(y.jsx)("video",{playsInline:!0,muted:!0,ref:c,autoPlay:!0,className:N.myvideo})]}),Object(y.jsx)(S.a,{style:{color:"grey"},children:Object(y.jsx)("span",{className:"icons",onClick:function(){return r()},tabIndex:"0",children:c?Object(y.jsx)(u.a,{style:{color:"#108ee9"}}):Object(y.jsx)(j.a,{style:{color:"red"}})})}),Object(y.jsx)(S.a,{style:{color:"grey"},children:Object(y.jsx)("span",{className:"icons",onClick:function(){return s()},tabIndex:"0",children:i?Object(y.jsx)(b.a,{style:{color:"#108ee9"}}):Object(y.jsx)(m.a,{style:{color:"red"}})})}),g?Object(y.jsx)(S.a,{style:{color:"grey"},children:Object(y.jsxs)("span",{className:"icons",onClick:function(){return v()},tabIndex:"0",children:["(",Object(y.jsx)(O.a,{style:{color:"#108ee9"}}),")"]})}):Object(y.jsx)(S.a,{style:{color:"grey"},children:Object(y.jsxs)("span",{className:"icons",onClick:function(){return h()},tabIndex:"0",children:["(",Object(y.jsx)(p.a,{style:{color:"#108ee9"}}),")"]})})]}),n&&!f&&Object(y.jsx)(l.a,{className:N.paper,children:Object(y.jsxs)(o.a,{item:!0,xs:6,sm:3,children:[Object(y.jsx)(d.a,{variant:"h5",gutterBottom:!0,children:C.name||"Name"}),Object(y.jsx)("video",{playsInline:!0,ref:x,autoPlay:!0,className:N.uservideo})]})}),Object(y.jsx)(T,{})]})},A=n(115),E=n(228),B=n(229),P=n(230),z=Object(s.a)((function(e){return{root:{display:"flex",flexDirection:"column"},gridContainer:Object(i.a)({width:"150%"},e.breakpoints.down("xs"),{flexDirection:"column"}),container:Object(i.a)({width:"600px",margin:"0px 0",padding:0},e.breakpoints.down("xs"),{width:"100%"}),margin:{marginTop:20},padding:{padding:20},paper:{padding:"10px 20px",border:"2px solid black"}}})),W=function(e){var t=e.children,n=Object(a.useContext)(w),c=n.me,r=n.callAccepted,i=n.name,s=n.setName,u=n.callEnded,j=n.leaveCall,b=n.callUser,m=Object(a.useState)(""),O=Object(x.a)(m,2),p=O[0],f=O[1],h=z();return Object(y.jsx)("div",{className:h.container,children:Object(y.jsxs)(l.a,{className:h.paper,children:[Object(y.jsx)("form",{className:h.root,noValidate:!0,autoComplete:"off",children:Object(y.jsxs)(o.a,{container:!0,className:h.gridContainer,children:[Object(y.jsxs)(o.a,{item:!0,xs:12,md:6,className:h.padding,children:[Object(y.jsx)(d.a,{gutterBottom:!0,variant:"h6",children:"Account Info"}),Object(y.jsx)(M.a,{label:"Name",value:i,onChange:function(e){return s(e.target.value)},fullWidth:!0}),console.log(c),Object(y.jsx)(A.CopyToClipboard,{text:c,className:h.margin,children:Object(y.jsx)(S.a,{variant:"contained",color:"primary",startIcon:Object(y.jsx)(E.a,{fontSize:"large"}),children:"Copy Your ID"})})]}),Object(y.jsxs)(o.a,{item:!0,xs:12,md:6,className:h.padding,children:[Object(y.jsx)(d.a,{gutterBottom:!0,variant:"h6",children:"Make a call"}),Object(y.jsx)(M.a,{label:"ID to call",value:p,onChange:function(e){return f(e.target.value)},fullWidth:!0}),r&&!u?Object(y.jsx)(S.a,{variant:"contained",color:"secondary",startIcon:Object(y.jsx)(B.a,{fontSize:"large"}),fullWidth:!0,onClick:j,className:h.margin,children:"Hang Up"}):Object(y.jsx)(S.a,{variant:"contained",color:"primary",startIcon:Object(y.jsx)(P.a,{fontSize:"large"}),onClick:function(){return b(p)},className:h.margin,children:"Video Call"})]})]})}),t]})})},H=function(){var e=Object(a.useContext)(w),t=e.answerCall,n=e.call,c=e.callAccepted,r=e.leaveCall;return Object(y.jsx)(y.Fragment,{children:n.isReceivingCall&&!c&&Object(y.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[Object(y.jsxs)("h1",{children:[n.name," is calling :"]}),Object(y.jsx)(S.a,{variant:"contained",color:"primary",onClick:t,children:"Answer"}),Object(y.jsx)(S.a,{variant:"contained",color:"secondary",onClick:r,children:"Reject"})]})})},L=n(121),F=n(13),J=n(235),Y=function(e){return Object(y.jsx)("button",{onClick:function(){var t=Object(J.a)();e.history.push("/room/".concat(t))},children:"Create room"})},q=n(77),G=n(78),K=G.a.div(D||(D=Object(q.a)(["\n    padding: 20px;\n    display: flex;\n    height: 100vh;\n    width: 90%;\n    margin: auto;\n    flex-wrap: wrap;\n"]))),Q=G.a.video(V||(V=Object(q.a)(["\n    height: 40%;\n    width: 50%;\n"]))),X=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){e.peer.on("stream",(function(e){t.current.srcObject=e}))}),[]),Object(y.jsx)(Q,{playsInline:!0,autoPlay:!0,ref:t})},Z={height:window.innerHeight/2,width:window.innerWidth/2},$=function(e){var t=Object(a.useState)([]),n=Object(x.a)(t,2),c=n[0],r=n[1],i=Object(a.useRef)(),s=Object(a.useRef)(),o=Object(a.useRef)([]);return Object(a.useEffect)((function(){i.current=h.a.connect("/"),navigator.mediaDevices.getUserMedia({video:Z,audio:!0}).then((function(e){s.current.srcObject=e,i.current.emit("join room"),i.current.on("all users",(function(t){var n=[];t.forEach((function(t){var a=function(e,t,n){var a=new v.a({initiator:!0,trickle:!1,stream:n});return a.on("signal",(function(n){i.current.emit("sending signal",{userToSignal:e,callerID:t,signal:n})})),a}(t,i.current.id,e);o.current.push({peerID:t,peer:a}),n.push(a)})),r(n)})),i.current.on("user joined",(function(t){var n=function(e,t,n){var a=new v.a({initiator:!1,trickle:!1,stream:n});return a.on("signal",(function(e){i.current.emit("returning signal",{signal:e,callerID:t})})),a.signal(e),a}(t.signal,t.callerID,e);o.current.push({peerID:t.callerID,peer:n}),r((function(e){return[].concat(Object(I.a)(e),[n])}))})),i.current.on("receiving returned signal",(function(e){o.current.find((function(t){return t.peerID===e.id})).peer.signal(e.signal)}))}))}),[]),Object(y.jsxs)(K,{children:[Object(y.jsx)(Q,{muted:!0,ref:s,autoPlay:!0,playsInline:!0}),c.map((function(e,t){return Object(y.jsx)(X,{peer:e},t)}))]})},_=n(232),ee=n(233),te=Object(s.a)((function(e){return{root:{display:"flex",flexDirection:"column"},gridContainer:Object(i.a)({width:"150%"},e.breakpoints.down("xs"),{flexDirection:"column"}),container:Object(i.a)({width:"600px",margin:"0px 0",padding:0},e.breakpoints.down("xs"),{width:"100%"}),margin:{marginTop:20},padding:{padding:20},paper:{padding:"10px 20px",border:"2px solid black"},wrapper:{width:"100%"}}})),ne=function(){var e=Object(a.useContext)(w),t=(e.answerCall,e.callEnded),n=(e.call,e.callAccepted),c=e.leaveCall,r=te();return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("div",{className:r.wrapper,children:Object(y.jsxs)(_.a,{bg:"primary",variant:"dark",children:[Object(y.jsx)(_.a.Brand,{href:"#",children:"Video Chat App"}),Object(y.jsx)(ee.a,{className:"mr-auto",children:Object(y.jsx)(ee.a.Link,{href:"/room",children:"Room"})}),Object(y.jsx)("div",{children:n&&!t?Object(y.jsx)(S.a,{variant:"contained",color:"secondary",startIcon:Object(y.jsx)(B.a,{fontSize:"large"}),onClick:c,className:r.margin,children:"Hang Up"}):Object(y.jsx)("div",{})})]})})})},ae=Object(s.a)((function(e){return{appBar:Object(i.a)({borderRadius:15,margin:"30px 100px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"left",width:"600px",border:"2px solid black",backgroundcolor:"pink"},e.breakpoints.down("xs"),{width:"90%"}),image:{marginLeft:"15px"},wrapper:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}}})),ce=function(){var e=ae();return Object(y.jsxs)("div",{className:e.wrapper,children:[Object(y.jsx)(ne,{}),Object(y.jsx)(L.a,{children:Object(y.jsxs)(F.c,{children:[Object(y.jsx)(F.a,{path:"/",exact:!0,component:Y}),Object(y.jsx)(F.a,{path:"/room/:roomID",component:$})]})}),Object(y.jsx)(U,{}),Object(y.jsx)(H,{}),Object(y.jsx)(W,{})]})};n(183);r.a.render(Object(y.jsx)(C,{children:Object(y.jsx)(ce,{})}),document.getElementById("root"))}},[[184,1,2]]]);
//# sourceMappingURL=main.d5c361d3.chunk.js.map